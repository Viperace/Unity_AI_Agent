// Install mathnet
// https://answers.unity.com/questions/462042/unity-and-mathnet.html

public static float[] GenerateCorrelatedRandomVariables(float[,] corr_matrix)
{
	// Get dimension
	n = corr_matrix.Length(0);

	// Create lower diagonal matrix
	float[,] Lmat = MyStatistics.Cholesky_Decomposition(corr_matrix, n);

	// Create IID RV
	var rng = new System.Random();
	float[] eps = new float[n];
	for(int i = 0; i < n; i++)
		eps[i] = rng.NextGaussian();

	// Matrix multiplication
	// Corr RV = L * IID_RV
	Matrix<double> m;
	m.DenseOfArray(corr_matrix);

	Vector<double> v;
	v.Dense(eps);

	var corrRV = m.Multiply(v);

	return corrRV
}
